{"version":3,"sources":["app.min.js"],"names":["config","$routeProvider","$locationProvider","NotificationProvider","setOptions","delay","startTop","startRight","verticalSpacing","horizontalSpacing","positionX","positionY","when","templateUrl","controller","controllerAs","otherwise","redirectTo","html5Mode","run","$rootScope","$location","$timeout","authService","$on","componentHandler","upgradeAllRegistered","event","nextRoute","currentRoute","console","log","path","isLoggedIn","angular","module","$http","$window","$localStorage","register","user","post","login","saveToken","token","fitforlife_token","getToken","payload","split","atob","JSON","parse","exp","Date","now","currentUser","email","_email","name","_name","logout","$localstorage","remove","service","$inject","loginCtrl","$scope","notify","vm","this","auth","_password","loading","then","response","success","message","data","title","statusText","err","error","registerCtrl","_confirm_password","dialog","document","querySelector","showModal","addEventListener","close","feedsCtrl"],"mappings":"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","file":"app.min.js","sourcesContent":["angular.module('fitforlife', ['ngRoute', 'ngMessages', 'angular-ladda', 'ui-notification', 'ngStorage']);\r\n\r\nfunction config($routeProvider, $locationProvider, NotificationProvider) {\r\n  NotificationProvider.setOptions({\r\n    delay: 2000,\r\n    startTop: 20,\r\n    startRight: 10,\r\n    verticalSpacing: 20,\r\n    horizontalSpacing: 20,\r\n    positionX: 'center',\r\n    positionY: 'bottom'\r\n  });\r\n\r\n  $routeProvider\r\n    .when('/register', {\r\n      templateUrl: 'views/_auth/register.view.html',\r\n      controller: 'registerCtrl',\r\n      controllerAs: 'vm'\r\n    }).when('/login', {\r\n      templateUrl: 'views/_auth/login.view.html',\r\n      controller: 'loginCtrl',\r\n      controllerAs: 'vm'\r\n    }).when('/home', {\r\n      templateUrl: 'views/_home/home.view.html',\r\n      controller: 'homeCtrl',\r\n      controllerAs: 'vm'\r\n    }).when('/feeds', {\r\n      templateUrl: 'views/_feeds/feeds.view.html',\r\n      controller: 'feedsCtrl',\r\n      controllerAs: 'vm'\r\n    })\r\n    .otherwise({\r\n      redirectTo: '/home'\r\n    });\r\n\r\n  // use the HTML5 History API\r\n  $locationProvider.html5Mode(true);\r\n}\r\n\r\nfunction run($rootScope, $location, $timeout, authService) {\r\n  $rootScope.$on('$viewContentLoaded', function() {\r\n    $timeout(function() {\r\n      componentHandler.upgradeAllRegistered();\r\n    });\r\n  });\r\n  $rootScope.$on('$routeChangeStart', function(event, nextRoute, currentRoute) {\r\n    console.log(\"redirect to: \" + $location.path());\r\n    if (authService.isLoggedIn()) { // check if user is logged in\r\n      // user is logged in\r\n      console.log(\"logged in\");\r\n    } else {\r\n      if (($location.path() != '/login' && $location.path() != '/register' && $location.path() != '/')) {\r\n        $location.path('/');\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nangular.module('fitforlife').config(['$routeProvider', '$locationProvider', 'NotificationProvider', config])\r\n  .run(['$rootScope', '$location', '$timeout', 'authService', run]);\r\n\n// /* common sessionStorage */\n// angular.module('fitforlife').factory('$sessionStorage', ['$window', function($window) {\n//   return {\n//     set: function(key, value) {\n//       $window.sessionStorage[key] = value;\n//     },\n//     get: function(key) {\n//       return $window.sessionStorage[key] || '';\n//     },\n//     setObject: function(key, value) {\n//       $window.sessionStorage[key] = JSON.stringify(value);\n//     },\n//     getObject: function(key) {\n//       if ($window.sessionStorage[key] != \"undefined\") {\n//         var value = $window.sessionStorage[key];\n//         if (value != undefined)\n//           return JSON.parse(value);\n//         else\n//           return {};\n//       }\n//       return {};\n//     },\n//     remove: function(key) {\n//       $window.sessionStorage.removeItem(key);\n//     },\n//     clear: function() {\n//       $window.sessionStorage.clear();\n//     }\n//   }\n// }]);\n\n// /* common localstorage */\n// angular.module('fitforlife').factory('$localstorage', ['$window', function($window) {\n//   return {\n//     set: function(key, value) {\n//       $window.localStorage[key] = value;\n//     },\n//     get: function(key) {\n//       return $window.localStorage[key] || '';\n//     },\n//     setObject: function(key, value) {\n//       $window.localStorage[key] = JSON.stringify(value);\n//     },\n//     getObject: function(key) {\n//       if ($window.localStorage[key] != \"undefined\") {\n//         var value = $window.localStorage[key];\n//         if (value != undefined)\n//           return JSON.parse(value);\n//         else\n//           return {};\n//       }\n//       return {};\n//     },\n//     remove: function(key) {\n//       $window.localStorage.removeItem(key);\n//     },\n//     clear: function() {\n//       $window.localStorage.clear();\n//     }\n//   }\n// }]);\n\n(function() {\r\n\r\n  angular\r\n    .module('fitforlife')\r\n    .service('authService', authService);\r\n\r\n  authService.$inject = ['$http', '$window', '$localStorage'];\r\n\r\n  function authService($http, $window, $localStorage) {\r\n\r\n    var register = function(user) {\r\n      return $http.post('/api/register', user);\r\n    }\r\n\r\n    var login = function(user) {\r\n      return $http.post('/api/login', user);\r\n    }\r\n\r\n    var saveToken = function(token) {\r\n      $localStorage.fitforlife_token = token;\r\n    };\r\n\r\n    var getToken = function() {\r\n      console.log($localStorage.fitforlife_token);\r\n      return $localStorage.fitforlife_token;\r\n    };\r\n\r\n    var isLoggedIn = function() {\r\n      var token = getToken();\r\n      console.log(token);\r\n      var payload;\r\n      if (token) {\r\n        payload = token.split('.')[1];\r\n        payload = $window.atob(payload);\r\n        payload = JSON.parse(payload);\r\n        console.log(payload);\r\n        console.log(payload.exp > Date.now() / 1000);\r\n        return payload.exp > Date.now() / 1000;\r\n      } else {\r\n        return false;\r\n      }\r\n    };\r\n\r\n    var currentUser = function() {\r\n      if (isLoggedIn()) {\r\n        var token = getToken();\r\n        var payload = token.split('.')[1];\r\n        payload = $window.atob(payload);\r\n        payload = JSON.parse(payload);\r\n        return {\r\n          email: payload._email,\r\n          name: payload._name\r\n        };\r\n      }\r\n    };\r\n\r\n    logout = function() {\r\n      $localstorage.remove('fitforlife-token');\r\n    };\r\n\r\n\r\n    return {\r\n      register: register,\r\n      login: login,\r\n      saveToken: saveToken,\r\n      getToken: getToken,\r\n      isLoggedIn: isLoggedIn,\r\n      currentUser: currentUser,\r\n      logout: logout\r\n    };\r\n  }\r\n})();\r\n\n(function() {\r\n  angular\r\n    .module('fitforlife')\r\n    .controller('loginCtrl', loginCtrl);\r\n\r\n  loginCtrl.$inject = ['$scope', '$location', '$localStorage', '$timeout', 'authService', 'Notification'];\r\n\r\n  function loginCtrl($scope, $location, $localStorage, $timeout, authService, notify) {\r\n    var vm = this;\r\n    vm.auth = {\r\n      _email: '',\r\n      _password: '',\r\n    }\r\n    vm.loading = false;\r\n    vm.login = function() {\r\n      vm.loading = true;\r\n      authService.login(vm.auth)\r\n        .then(function(response) {\r\n          notify.success({\r\n            message: response.data.message,\r\n            title: response.statusText\r\n          });\r\n          authService.saveToken(response.data.token);\r\n          $timeout(function() {\r\n            $location.path('feed');\r\n          }, 500);\r\n        }).catch(function(err) {\r\n          notify.error({\r\n            message: err.data.message,\r\n            title: err.statusText\r\n          });\r\n        }).finally(function() {\r\n          vm.loading = false;\r\n        });\r\n    }\r\n  }\r\n})();\r\n\n(function() {\r\n  angular\r\n    .module('fitforlife')\r\n    .controller('registerCtrl', registerCtrl);\r\n\r\n  registerCtrl.$inject = ['$scope', '$location', 'authService', 'Notification'];\r\n\r\n  function registerCtrl($scope, $location, authService, notify) {\r\n    var vm = this;\r\n    vm.user = {\r\n      _name: '',\r\n      _email: '',\r\n      _password: '',\r\n      _confirm_password: ''\r\n    }\r\n    vm.loading = false;\r\n    vm.register = function() {\r\n      vm.loading = true;\r\n      authService.register(vm.user)\r\n        .then(function(response) {\r\n          console.log(response);\r\n          notify.success({\r\n            message: response.data.message,\r\n            title: response.statusText\r\n          });\r\n          var dialog = document.querySelector('dialog');\r\n          dialog.showModal();\r\n          dialog.querySelector('.close-modal').addEventListener('click', function() {\r\n            dialog.close();            \r\n          });\r\n\r\n        }).catch(function(err) {\r\n          console.log(err);\r\n          notify.error({\r\n            message: err.data.message,\r\n            title: err.statusText\r\n          });\r\n        }).finally(function() {\r\n          vm.loading = false;\r\n        });\r\n    }\r\n  }\r\n})();\r\n\n(function() {\r\n  angular\r\n    .module('fitforlife')\r\n    .controller('feedsCtrl', feedsCtrl);\r\n\r\n  function feedsCtrl() {\r\n\r\n  }\r\n})();\r\n\n(function() {\r\n  angular\r\n    .module('fitforlife')\r\n    .controller('homeCtrl', loginCtrl);\r\n\r\n  function loginCtrl() {\r\n\r\n  }\r\n})();\r\n"],"sourceRoot":"/source/"}